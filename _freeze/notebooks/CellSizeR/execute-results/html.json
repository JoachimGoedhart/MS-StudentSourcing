{
  "hash": "7f83e18188c05af741737ef6dc0af936",
  "result": {
    "markdown": "---\ntitle: Summarizing the size of cells\nauthor: \"Joachim Goedhart\"\nformat: html\n---\n\n::: {.cell .hidden warning.hidden='true' message.hidden='true'}\n\n```{.r .cell-code .hidden}\n### Load the required packages\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0     ✔ purrr   0.3.4\n✔ tibble  3.1.7     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n\n\n:::\n:::\n\n::: {.cell .hidden warning.hidden='true' message.hidden='true'}\n\n```{.r .cell-code .hidden}\n### Read the data\n\ndf_sheet <- read.csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vSc-nI1-s_u-XkNXEn_u2l6wkBafxJMHQ_Cd3kStrnToh7kawqjQU3y2l_1riLigKRkIqlNOqPrgkdW/pub?output=csv\", na.strings = \"\")\ndf_sheet <- df_sheet %>% na.omit()\n\ncolnames(df_sheet) <- c(\"Timestamp\", \"Group\", \"Cell\", \"Nucleus\")\ndf_tidy <-\n    pivot_longer(\n        df_sheet,\n        cols = -c(\"Timestamp\", \"Group\"),\n        names_to = \"Sample\",\n        values_to = \"Size\"\n    ) %>% mutate(Size = gsub(\" \", \"\", Size)) %>% separate_rows(Size, sep=\",\")\n\ndf_clean <- df_tidy %>% mutate(Size = as.numeric(Size)) %>% filter(Size>0 & Size<1000)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in mask$eval_all_mutate(quo): NAs introduced by coercion\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ndf <- df_clean %>% separate('Timestamp', c(\"Date\", \"Time\"), sep=\" \") %>%\n    separate('Date', c(\"day\", \"month\", \"year\"), sep=\"/\", convert = TRUE)\n```\n:::\n\n::: {#cell-fig-histogram .cell warning.hidden='true' message.hidden='true'}\n\n```{.r .cell-code .hidden}\n#| label: fig-histogram\n#| fig-cap: Distribution of the measured size of human cheek cells and their nucleus. Data from three years.\n#| warning: false\n\nggplot(df, aes(x=Size, fill=Sample)) +\n  \n  geom_histogram(bins = 100, alpha=.8, color='grey40') +\n  # scale_x_log10() +\n  labs(y=\"Count\", x=\"Size [µm]\") +\n  # coord_cartesian(xlim = c(0.5,120)) +\n  theme_light(base_size = 16) + theme(axis.text.y = element_blank()) +\n  facet_wrap(~Sample) +\n  theme(legend.position = \"none\") +\n  \n  #Force the y-axis to start at zero\n  scale_y_continuous(expand = c(0, NA), limits = c(0,150)) +\n  #Apply a logarithmic scale to the x-axis and set the numbers for the scale\n  scale_x_log10(breaks = c(1,10,100), limits = c(.5,200)) +\n  #Remove minor gridlines\n  theme(panel.grid.minor = element_blank()) +\n  #Add ticks to the bottom, outside\n  annotation_logticks(sides=\"b\", outside = TRUE) +\n  #Give a little more space to the log-ticks by adding margin to the top of the x-axis text\n  theme(axis.text.x = element_text(margin = margin(t=8))) +\n  #Needed to see the tcks outside the plot panel\n  coord_cartesian(clip = \"off\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 11 rows containing non-finite values (`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 4 rows containing missing values (`geom_bar()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![Distribution of the measured size of human cheek cells and their nucleus. Data from three years.](CellSizeR_files/figure-html/fig-histogram-1.png){#fig-histogram width=672}\n:::\n:::\n\n::: {.cell warning.hidden='true' message.hidden='true'}\n\n```{.r .cell-code .hidden}\ndf_cell <- df %>% filter(Sample ==\"Cell\")\n\n        p <- ggplot(df_cell, aes(x=Group, y=Size, fill=Group))\n\n        p <- p + geom_violin() +  stat_summary(fun = median, geom = \"point\")\n        \n        p <- p + scale_y_log10()\n        \n        p <- p + labs(x=\"Group\", y=\"Size [µm]\")\n        p <- p + coord_cartesian(ylim = c(0.5,200))\n        \n        p <- p + theme_light(base_size = 16)\n        p <- p + theme(legend.position = \"none\")\n\np\n```\n\n::: {.cell-output-display}\n![](CellSizeR_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "CellSizeR_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}